<div class="profile-page" [@fadeIn]>
  <div class="container">
    <!-- Page Header -->
    <div class="page-header">
      <h1 class="page-title">{{ 'COMMON.PROFILE' | translate }}</h1>
      <p class="page-subtitle">{{ 'PROFILE.MANAGE_YOUR_ACCOUNT' | translate }}</p>
    </div>

    <!-- Profile Form -->
    <div class="profile-content">
      <div class="profile-card">
        <div class="card-header">
          <h2 class="card-title">{{ 'PROFILE.PERSONAL_INFO' | translate }}</h2>
        </div>

        <div class="card-body">
          <!-- Success Message -->
          @if (success()) {
            <div class="alert alert-success">
              {{ success() }}
            </div>
          }

          <!-- Error Message -->
          @if (error()) {
            <div class="alert alert-error">
              {{ error() }}
            </div>
          }

          <form (ngSubmit)="updateProfile()">
            <!-- Email (Read-only) -->
            <div class="form-group">
              <label class="form-label">{{ 'COMMON.EMAIL' | translate }}</label>
              <input
                type="email"
                class="form-input"
                [value]="email()"
                disabled
              />
              <p class="form-hint">{{ 'PROFILE.EMAIL_CANNOT_CHANGE' | translate }}</p>
            </div>

            <!-- Display Name -->
            <div class="form-group">
              <label class="form-label">{{ 'PROFILE.DISPLAY_NAME' | translate }}</label>
              <input
                type="text"
                class="form-input"
                [value]="displayName()"
                (input)="displayName.set($any($event.target).value)"
                [placeholder]="'PROFILE.ENTER_NAME' | translate"
              />
              <p class="form-hint">{{ 'PROFILE.NAME_HINT' | translate }}</p>
            </div>

            <!-- Submit Button -->
            <div class="form-actions">
              <button
                type="submit"
                class="btn btn-primary"
                [disabled]="saving()"
              >
                @if (saving()) {
                  <span class="btn-spinner"></span>
                }
                {{ 'COMMON.SAVE_CHANGES' | translate }}
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Account Info Card -->
      <div class="profile-card">
        <div class="card-header">
          <h2 class="card-title">{{ 'PROFILE.ACCOUNT_INFO' | translate }}</h2>
        </div>

        <div class="card-body">
          <div class="info-row">
            <span class="info-label">{{ 'PROFILE.ACCOUNT_TYPE' | translate }}:</span>
            <span class="info-value">
              @if (authService.isAdmin()) {
                <span class="badge badge-admin">{{ 'PROFILE.ADMIN' | translate }}</span>
              } @else {
                <span class="badge badge-user">{{ 'PROFILE.USER' | translate }}</span>
              }
            </span>
          </div>
        </div>
      </div>

      <!-- Saved Recipes Card -->
      <div class="profile-card saved-recipes-card">
        <div class="card-header">
          <h2 class="card-title">{{ 'PROFILE.SAVED_RECIPES' | translate }}</h2>
        </div>

        <div class="card-body">
          @if (loadingSavedRecipes()) {
            <div class="loading-state">
              <div class="spinner"></div>
              <p>{{ 'COMMON.LOADING' | translate }}</p>
            </div>
          } @else if (savedRecipes().length === 0) {
            <div class="empty-state">
              <p>{{ 'PROFILE.NO_SAVED_RECIPES' | translate }}</p>
            </div>
          } @else {
            <div class="saved-recipes-grid">
              @for (recipe of savedRecipes(); track recipe.id) {
                <a [routerLink]="['/recipes', recipe.slug]" class="saved-recipe-card">
                  <div class="recipe-image">
                    @if (recipe.image_url) {
                      <img [src]="recipe.image_url" [alt]="recipe.title" />
                    } @else {
                      <div class="recipe-image-placeholder">
                        <span class="placeholder-icon">üç≥</span>
                      </div>
                    }
                  </div>
                  <div class="recipe-info">
                    <h3 class="recipe-title">{{ recipe.title }}</h3>
                    <div class="recipe-meta">
                      <span class="meta-item">‚è±Ô∏è {{ recipe.prep_time }} {{ 'RECIPE.MINUTES' | translate }}</span>
                      <span class="meta-item">üçΩÔ∏è {{ recipe.servings }}</span>
                    </div>
                  </div>
                </a>
              }
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
