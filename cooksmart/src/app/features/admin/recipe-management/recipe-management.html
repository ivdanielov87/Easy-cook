<div class="recipe-management-page" [@fadeIn]>
  <div class="page-header">
    <h1 class="page-title">{{ 'NAV.MANAGE_RECIPES' | translate }}</h1>
    <p class="page-subtitle">{{ 'ADMIN.MANAGE_RECIPES_DESC' | translate }}</p>
  </div>

  <div class="page-actions">
    <div class="search-box">
      <input
        type="text"
        class="search-input"
        [value]="searchQuery()"
        (input)="onSearchChange($any($event.target).value)"
        [placeholder]="'COMMON.SEARCH' | translate"
      />
    </div>
    <a routerLink="/admin/recipes/new" class="btn btn-primary">
      <span class="btn-icon-plus">+</span>
      {{ 'ADMIN.CREATE_RECIPE' | translate }}
    </a>
  </div>

  @if (loading()) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>{{ 'COMMON.LOADING' | translate }}</p>
    </div>
  } @else if (filteredRecipes().length === 0) {
    <div class="empty-state">
      <p class="empty-icon">üìù</p>
      <p class="empty-text">
        @if (searchQuery()) {
          {{ 'PANTRY.NO_RECIPES_FOUND' | translate }}
        } @else {
          No recipes yet. Create your first recipe!
        }
      </p>
    </div>
  } @else {
    <div class="recipes-table" [@staggerList]>
      <!-- Mobile Card View -->
      @for (recipe of filteredRecipes(); track recipe.id) {
        <div class="mobile-recipe-card">
          <div class="card-header">
            @if (recipe.image_url) {
              <img [src]="recipe.image_url" [alt]="recipe.title" class="recipe-thumb" />
            }
            <div class="recipe-info-mobile">
              <div class="recipe-title">{{ recipe.title }}</div>
              @if (recipe.description) {
                <div class="recipe-description">{{ recipe.description }}</div>
              }
            </div>
          </div>
          
          <div class="card-meta">
            <div class="meta-item">
              <div class="meta-label">{{ 'RECIPE.DIFFICULTY' | translate }}</div>
              <div class="meta-value">
                <span class="badge" [class]="'badge-' + recipe.difficulty">
                  {{ getDifficultyLabel(recipe.difficulty) | translate }}
                </span>
              </div>
            </div>
            <div class="meta-item">
              <div class="meta-label">{{ 'RECIPE.PREP_TIME' | translate }}</div>
              <div class="meta-value">{{ recipe.prep_time }}m</div>
            </div>
            <div class="meta-item">
              <div class="meta-label">{{ 'RECIPE.SERVINGS' | translate }}</div>
              <div class="meta-value">{{ recipe.servings }}</div>
            </div>
          </div>
          
          <div class="card-actions">
            <a [routerLink]="['/recipes', recipe.slug]" class="btn-icon" title="View">
              üëÅÔ∏è
            </a>
            <a [routerLink]="['/admin/recipes/edit', recipe.id]" class="btn-icon" title="Edit">
              ‚úèÔ∏è
            </a>
            <button class="btn-icon btn-danger" (click)="deleteRecipe(recipe.id)" title="Delete">
              üóëÔ∏è
            </button>
          </div>
        </div>
      }
      
      <!-- Desktop Table View -->
      <table>
        <thead>
          <tr>
            <th>{{ 'RECIPE.TITLE' | translate }}</th>
            <th>{{ 'RECIPE.DIFFICULTY' | translate }}</th>
            <th>{{ 'RECIPE.PREP_TIME' | translate }}</th>
            <th>{{ 'RECIPE.SERVINGS' | translate }}</th>
            <th class="actions-column">{{ 'COMMON.ACTIONS' | translate }}</th>
          </tr>
        </thead>
        <tbody>
          @for (recipe of filteredRecipes(); track recipe.id) {
            <tr>
              <td>
                <div class="recipe-info">
                  @if (recipe.image_url) {
                    <img [src]="recipe.image_url" [alt]="recipe.title" class="recipe-thumb" />
                  }
                  <div class="recipe-details">
                    <div class="recipe-title">{{ recipe.title }}</div>
                    @if (recipe.description) {
                      <div class="recipe-description">{{ recipe.description }}</div>
                    }
                  </div>
                </div>
              </td>
              <td>
                <span class="badge" [class]="'badge-' + recipe.difficulty">
                  {{ getDifficultyLabel(recipe.difficulty) | translate }}
                </span>
              </td>
              <td>{{ recipe.prep_time }} {{ 'RECIPE.MINUTES' | translate }}</td>
              <td>{{ recipe.servings }}</td>
              <td class="actions-column">
                <div class="action-buttons">
                  <a [routerLink]="['/recipes', recipe.slug]" class="btn-icon" title="View">
                    üëÅÔ∏è
                  </a>
                  <a [routerLink]="['/admin/recipes/edit', recipe.id]" class="btn-icon" title="Edit">
                    ‚úèÔ∏è
                  </a>
                  <button class="btn-icon btn-danger" (click)="deleteRecipe(recipe.id)" title="Delete">
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>
