<div class="main-layout">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container navbar-content">
      <!-- Logo -->
      <div class="navbar-brand">
        <a routerLink="/" class="logo">
          <span class="logo-icon">üç≥</span>
          <span class="logo-text">CookSmart</span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="navbar-menu desktop-only">
        <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
          {{ 'COMMON.HOME' | translate }}
        </a>
        <a routerLink="/pantry" routerLinkActive="active" class="nav-link">
          {{ 'COMMON.MY_PANTRY' | translate }}
        </a>
      </div>

      <!-- Desktop Actions -->
      <div class="navbar-actions desktop-only">
        <!-- Language Switcher -->
        <div class="dropdown" [class.open]="languageMenuOpen()">
          <button class="btn-icon" (click)="toggleLanguageMenu()" type="button">
            <span class="lang-flag">{{ translateService.currentLang() === 'bg' ? 'üáßüá¨' : 'üá¨üáß' }}</span>
            <span class="lang-code">{{ translateService.currentLang().toUpperCase() }}</span>
          </button>
          @if (languageMenuOpen()) {
            <div class="dropdown-menu">
              <button class="dropdown-item" (click)="switchLanguage('bg')" type="button">
                <span class="lang-flag">üáßüá¨</span> –ë—ä–ª–≥–∞—Ä—Å–∫–∏
              </button>
              <button class="dropdown-item" (click)="switchLanguage('en')" type="button">
                <span class="lang-flag">üá¨üáß</span> English
              </button>
            </div>
          }
        </div>

        <!-- User Menu -->
        @if (authService.isAuthenticated()) {
          <div class="dropdown" [class.open]="userMenuOpen()">
            <button class="btn-icon user-avatar" (click)="toggleUserMenu()" type="button">
              @if (authService.currentProfile()?.avatar_url) {
                <img [src]="authService.currentProfile()?.avatar_url" alt="Avatar" />
              } @else {
                <span class="avatar-placeholder">{{ authService.currentProfile()?.display_name?.charAt(0) || 'U' }}</span>
              }
            </button>
            @if (userMenuOpen()) {
              <div class="dropdown-menu dropdown-menu-right">
                <div class="dropdown-header">
                  <div class="user-name">{{ authService.currentProfile()?.display_name || authService.currentUser()?.email }}</div>
                  <div class="user-email">{{ authService.currentUser()?.email }}</div>
                </div>
                <div class="dropdown-divider"></div>
                <a routerLink="/profile" class="dropdown-item" (click)="userMenuOpen.set(false)">
                  {{ 'COMMON.PROFILE' | translate }}
                </a>
                @if (authService.isAdmin()) {
                  <a routerLink="/admin" class="dropdown-item" (click)="userMenuOpen.set(false)">
                    {{ 'NAV.ADMIN' | translate }}
                  </a>
                }
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" (click)="logout()" type="button">
                  {{ 'COMMON.LOGOUT' | translate }}
                </button>
              </div>
            }
          </div>
        } @else {
          <a routerLink="/login" class="btn btn-primary">
            {{ 'COMMON.LOGIN' | translate }}
          </a>
        }
      </div>

      <!-- Mobile Hamburger -->
      <button class="hamburger mobile-only" (click)="toggleMobileMenu()" type="button" [class.active]="mobileMenuOpen()">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <!-- Mobile Menu -->
    @if (mobileMenuOpen()) {
      <div class="mobile-menu" [@fadeInOut]>
        <div class="mobile-menu-content">
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="mobile-nav-link" (click)="closeMobileMenu()">
            {{ 'COMMON.HOME' | translate }}
          </a>
          <a routerLink="/pantry" routerLinkActive="active" class="mobile-nav-link" (click)="closeMobileMenu()">
            {{ 'COMMON.MY_PANTRY' | translate }}
          </a>
          
          <div class="mobile-divider"></div>
          
          <!-- Language Switcher Mobile -->
          <div class="mobile-section-title">{{ 'COMMON.LANGUAGE' | translate }}</div>
          <button class="mobile-nav-link" (click)="switchLanguage('bg'); closeMobileMenu()" type="button">
            <span class="lang-flag">üáßüá¨</span> –ë—ä–ª–≥–∞—Ä—Å–∫–∏
          </button>
          <button class="mobile-nav-link" (click)="switchLanguage('en'); closeMobileMenu()" type="button">
            <span class="lang-flag">üá¨üáß</span> English
          </button>
          
          <div class="mobile-divider"></div>
          
          @if (authService.isAuthenticated()) {
            <a routerLink="/profile" class="mobile-nav-link" (click)="closeMobileMenu()">
              {{ 'COMMON.PROFILE' | translate }}
            </a>
            @if (authService.isAdmin()) {
              <a routerLink="/admin" class="mobile-nav-link" (click)="closeMobileMenu()">
                {{ 'NAV.ADMIN' | translate }}
              </a>
            }
            <button class="mobile-nav-link" (click)="logout(); closeMobileMenu()" type="button">
              {{ 'COMMON.LOGOUT' | translate }}
            </button>
          } @else {
            <a routerLink="/login" class="mobile-nav-link btn-primary-mobile" (click)="closeMobileMenu()">
              {{ 'COMMON.LOGIN' | translate }}
            </a>
          }
        </div>
      </div>
    }
  </nav>

  <!-- Main Content -->
  <main class="main-content" [@routeFadeIn]>
    <router-outlet></router-outlet>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container footer-content">
      <div class="footer-section">
        <div class="footer-brand">
          <span class="logo-icon">üç≥</span>
          <span class="logo-text">CookSmart</span>
        </div>
        <p class="footer-description">{{ 'FOOTER.COPYRIGHT' | translate }}</p>
      </div>
      
      <div class="footer-section">
        <h4 class="footer-title">{{ 'COMMON.LINKS' | translate }}</h4>
        <ul class="footer-links">
          <li><a routerLink="/">{{ 'COMMON.HOME' | translate }}</a></li>
          <li><a routerLink="/pantry">{{ 'COMMON.MY_PANTRY' | translate }}</a></li>
          <li><a href="#">{{ 'FOOTER.ABOUT' | translate }}</a></li>
          <li><a href="#">{{ 'FOOTER.CONTACT' | translate }}</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4 class="footer-title">{{ 'COMMON.LEGAL' | translate }}</h4>
        <ul class="footer-links">
          <li><a href="#">{{ 'FOOTER.PRIVACY' | translate }}</a></li>
          <li><a href="#">{{ 'FOOTER.TERMS' | translate }}</a></li>
        </ul>
      </div>
    </div>
  </footer>
</div>
